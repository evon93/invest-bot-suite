# AG-2D-03-3.4A Return Packet

**Fecha:** 2025-12-27  
**Objetivo:** Gates por modo (quick=sanity, full=quality) + num_trades métrica.

---

## Cambios YAML

```yaml
risk_constraints:
  gates:
    quick:   # Sanity (no exige sharpe/cagr)
      max_errors: 0
      require_candidate_params: true
      min_trades: 0
      max_drawdown_absolute: -0.50
    
    full:    # Quality (estricto)
      max_errors: 0
      require_candidate_params: true
      min_trades: 1
      max_drawdown_absolute: -0.15
      min_sharpe: 0.3
      min_cagr: 0.05
      max_pct_time_hard_stop: 0.25
```

---

## Cambios Runner

| Cambio | Descripción |
|--------|-------------|
| `check_gates()` | Soporta min_trades, gates opcionales (solo si especificados) |
| Selección gates | `gates = all_gates.get(mode, all_gates)` |
| `csv_headers` | Añadido `num_trades` |
| `run_meta.json` | Añadido `gates_profile` |
| `summary.md` | Añadida sección "Trade Statistics" |

---

## pytest Results

```
114 passed in 1.98s
```

---

## git log -1 --oneline

```
9adb5bd feat(runner): gates by mode (quick=sanity, full=quality) + num_trades metric
```

---

## DoD Checklist

- [x] quick sirve como sanity: pipeline puede "pasar" sin exigir sharpe/cagr
- [x] full queda como quality gate (estricto)
- [x] results.csv incluye num_trades
- [x] pytest global pasa
