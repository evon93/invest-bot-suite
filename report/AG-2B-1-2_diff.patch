diff --git a/backtest_initial.py b/backtest_initial.py
index 7751077..7cbea65 100644
--- a/backtest_initial.py
+++ b/backtest_initial.py
@@ -9,6 +9,7 @@ import logging
 import os
 from datetime import datetime
 from pathlib import Path
+from collections import defaultdict
 from typing import Dict, List, Union
 
 import numpy as np
@@ -80,6 +81,8 @@ class SimpleBacktester:
         self.portfolio_value: List[float] = [initial_capital]
         self.positions: Dict[str, float] = {c: 0.0 for c in self.prices.columns}
         self.trades: List[Dict] = []
+        self.closed_trades: List[Dict] = []  # Trades cerrados con PnL
+        self._avg_cost: Dict[str, float] = defaultdict(float)  # Coste medio por asset
         
         # Precios efectivos (├║ltimo precio v├ílido > 0 visto)
         self.last_valid_prices: Dict[str, float] = {}
